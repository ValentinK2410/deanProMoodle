<?xml version="1.0" encoding="UTF-8" ?>
<XMLDB PATH="local/deanpromoodle/db" VERSION="20260129" COMMENT="XMLDB file for Moodle local/deanpromoodle"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../../lib/xmldb/xmldb.xsd">
  <TABLES>
    <!-- Таблица предметов -->
    <TABLE NAME="local_deanpromoodle_subjects" COMMENT="Таблица предметов">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="name" TYPE="char" LENGTH="255" NOTNULL="true"/>
        <FIELD NAME="code" TYPE="char" LENGTH="100" NOTNULL="false"/>
        <FIELD NAME="shortdescription" TYPE="text" NOTNULL="false"/>
        <FIELD NAME="description" TYPE="text" NOTNULL="false"/>
        <FIELD NAME="sortorder" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0"/>
        <FIELD NAME="visible" TYPE="int" LENGTH="1" NOTNULL="true" DEFAULT="1"/>
        <FIELD NAME="timemodified" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0"/>
        <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="sortorder" UNIQUE="false" FIELDS="sortorder"/>
        <INDEX NAME="visible" UNIQUE="false" FIELDS="visible"/>
      </INDEXES>
    </TABLE>

    <!-- Связь предметов с курсами -->
    <TABLE NAME="local_deanpromoodle_subject_courses" COMMENT="Связь предметов с курсами">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="subjectid" TYPE="int" LENGTH="10" NOTNULL="true"/>
        <FIELD NAME="courseid" TYPE="int" LENGTH="10" NOTNULL="true"/>
        <FIELD NAME="sortorder" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0"/>
        <FIELD NAME="timemodified" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0"/>
        <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="subjectid" TYPE="foreign" FIELDS="subjectid" REFTABLE="local_deanpromoodle_subjects" REFFIELDS="id"/>
        <KEY NAME="courseid" TYPE="foreign" FIELDS="courseid" REFTABLE="course" REFFIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="subjectid" UNIQUE="false" FIELDS="subjectid"/>
        <INDEX NAME="courseid" UNIQUE="false" FIELDS="courseid"/>
        <INDEX NAME="subjectcourse" UNIQUE="true" FIELDS="subjectid, courseid"/>
        <INDEX NAME="sortorder" UNIQUE="false" FIELDS="sortorder"/>
      </INDEXES>
    </TABLE>

    <!-- Таблица программ -->
    <TABLE NAME="local_deanpromoodle_programs" COMMENT="Таблица программ">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="name" TYPE="char" LENGTH="255" NOTNULL="true"/>
        <FIELD NAME="code" TYPE="char" LENGTH="100" NOTNULL="false"/>
        <FIELD NAME="description" TYPE="text" NOTNULL="false"/>
        <FIELD NAME="institution" TYPE="char" LENGTH="255" NOTNULL="false"/>
        <FIELD NAME="visible" TYPE="int" LENGTH="1" NOTNULL="true" DEFAULT="1"/>
        <FIELD NAME="timemodified" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0"/>
        <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="visible" UNIQUE="false" FIELDS="visible"/>
      </INDEXES>
    </TABLE>

    <!-- Связь программ с предметами -->
    <TABLE NAME="local_deanpromoodle_program_subjects" COMMENT="Связь программ с предметами">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="programid" TYPE="int" LENGTH="10" NOTNULL="true"/>
        <FIELD NAME="subjectid" TYPE="int" LENGTH="10" NOTNULL="true"/>
        <FIELD NAME="sortorder" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0"/>
        <FIELD NAME="timemodified" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0"/>
        <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="programid" TYPE="foreign" FIELDS="programid" REFTABLE="local_deanpromoodle_programs" REFFIELDS="id"/>
        <KEY NAME="subjectid" TYPE="foreign" FIELDS="subjectid" REFTABLE="local_deanpromoodle_subjects" REFFIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="programid" UNIQUE="false" FIELDS="programid"/>
        <INDEX NAME="subjectid" UNIQUE="false" FIELDS="subjectid"/>
        <INDEX NAME="programsubject" UNIQUE="true" FIELDS="programid, subjectid"/>
        <INDEX NAME="sortorder" UNIQUE="false" FIELDS="sortorder"/>
      </INDEXES>
    </TABLE>

    <!-- Связь программ с когортами (глобальными группами) -->
    <TABLE NAME="local_deanpromoodle_program_cohorts" COMMENT="Связь программ с когортами">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="programid" TYPE="int" LENGTH="10" NOTNULL="true"/>
        <FIELD NAME="cohortid" TYPE="int" LENGTH="10" NOTNULL="true"/>
        <FIELD NAME="timemodified" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0"/>
        <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="programid" TYPE="foreign" FIELDS="programid" REFTABLE="local_deanpromoodle_programs" REFFIELDS="id"/>
        <KEY NAME="cohortid" TYPE="foreign" FIELDS="cohortid" REFTABLE="cohort" REFFIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="programid" UNIQUE="false" FIELDS="programid"/>
        <INDEX NAME="cohortid" UNIQUE="false" FIELDS="cohortid"/>
        <INDEX NAME="programcohort" UNIQUE="true" FIELDS="programid, cohortid"/>
      </INDEXES>
    </TABLE>
  </TABLES>
</XMLDB>
